(function(e){e.fn.autoresize=function(t){function i(e){var t="<br />";return(e+"<br />~<br />~").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+t+"$2")}var n=e.extend({debug:false},t),r=["font-family","font-size","font-weight","font-style","letter-spacing","text-transform","word-spacing","text-indent","line-height","padding-top","padding-bottom"];return this.each(function(){var t=e(this),s=e("<div></div>");t.css("overflow","hidden");e.each(r,function(e,n){s.css(n,t.css(n))});s.css({"word-wrap":"break-word",position:"absolute",height:"auto",width:t.width()});if(n.debug===false){s.css({top:"-999em",left:"-999em"})}else{s.css({top:"10px",left:"10px"})}s.html(i(t.val()));e("body").append(s);t.height(s.height());t.bind("textchange",function(){s.html(i(t.val()));t.height(s.height())})})};e.event.special.textchange={setup:function(t,n){e(this).data("lastValue",this.contentEditable==="true"?e(this).html():e(this).val());e(this).bind("keyup.textchange",e.event.special.textchange.handler);e(this).bind("cut.textchange paste.textchange input.textchange",e.event.special.textchange.delayedHandler)},teardown:function(t){e(this).unbind(".textchange")},handler:function(t){e.event.special.textchange.triggerIfChanged(e(this))},delayedHandler:function(t){var n=e(this);setTimeout(function(){e.event.special.textchange.triggerIfChanged(n)},25)},triggerIfChanged:function(e){var t=e[0].contentEditable==="true"?e.html():e.val();if(t!==e.data("lastValue")){e.trigger("textchange",[e.data("lastValue")]);e.data("lastValue",t)}}}})(jQuery)